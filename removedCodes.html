!!! navbarUniversity.hbs
<nav class="sidenav">
    <!-- sidenav -->
    <div class="navi">
        <div class="container container-logo">
            <div class="holder holder-logo">
                <div class="icon icon-logo">
                    <img src="../img/lsu.png" alt="LSU Logo" class="img-logo">
                </div>
                <div class="text text-logo">
                    <a href="/university-events-admin">Events and Attendance Tracking Website</a>
                </div>
            </div>
        </div>
        <h1>EVENTS</h1>
        <hr>
        <div class="container">
            <div class="flex-container">
                <div class="icon icon-textflag">
                    <img src="../img/Stackframe_fill.png" alt="Text Flag" class="img-textflag">
                </div>
                <div class="text text-textflag">INSTITUTIONAL</div>
            </div>
        </div>
        <a href="#" class="nav-link">PASIMULA</a>
        <a href="#" class="nav-link">KULTURANIMO</a>
        <a href="#" class="nav-link">PANAGHUGPONG</a>
        <a href="#" class="nav-link">PANAGSADYA</a>

        <div class="container container-widget">
            {{!-- <div class="holder holder-widget">
                <div class="icon icon-widget">
                    <a href="/college-events-edit">
                        <img src="../img/Menu.png" alt="Dashboard Icon">
                    </a>
                </div>
                <div class="text text-widget text-widget-dashboard">
                    <a href="/college-events-edit" class="link-widget">COLLEGE EDIT</a>
                </div>
            </div> --}}
            <div class="holder holder-widget">
                <div class="icon icon-widget">
                    <a href="/dashboard">
                        <img src="../img/Menu.png" alt="Dashboard Icon">
                    </a>
                </div>
                <div class="text text-widget text-widget-dashboard">
                    <a href="/dashboard" class="link-widget">DASHBOARD</a>
                </div>
            </div>

            <div class="holder holder-widget">
                <div class="icon icon-widget">
                    <a href="/university-events-edit">
                        <img src="../img/Edit.png" alt="Edit Mode Icon">
                    </a>
                </div>
                <div class="text text-widget text-widget-edit">
                    <a href="/university-events-edit" class="link-widget">EDIT MODE</a>
                </div>
            </div>

            <div class="holder holder-widget">
                <div class="icon icon-widget">
                    <a href="/logout"><img src="../img/On_button.png" alt="Log Out Icon"></a>
                </div>
                <div class="text text-widget text-widget-logout">
                    <a href="/logout" class="link-widget">LOG OUT</a>
                </div>
            </div>
        </div>
    </div>
</nav>



!!! popup.js REMOVED ACTIVITIES
document.getElementById('confirmButton').addEventListener('click', function (event) {
event.preventDefault();

// Collect form data from input fields
const formData = {
eventnameInput: document.getElementById('eventnameInput').value,
startDateEvent: document.getElementById('startDateEvent').value,
endDateEvent: document.getElementById('endDateEvent').value,
eventScope: document.getElementById('eventScope').textContent,
activityname: Array.from(document.querySelectorAll('[name="activityname[]"]')).map(input => input.value),
activitydate: Array.from(document.querySelectorAll('[name="activitydate[]"]')).map(input => input.value),
};

// Send the data to the server using the Fetch API
fetch('/insert-event-database', {
method: 'POST',
headers: {
'Content-Type': 'application/json',
},
body: JSON.stringify(formData),
})
.then((response) => {
if (response.ok) {
return response.json();
} else {
console.error('Error sending data to the server');
throw new Error('Server error');
}
})
.then((data) => {
const successResponse = document.getElementById('successResponse');
successResponse.textContent = data.message;

successResponse.classList.remove("hidden");
successResponse.classList.add("user-prompt", "slide-in");
setTimeout(function () {
successResponse.classList.add("hidden");
}, 4000);
})
.catch((error) => {
console.error('Error:', error);
});
});


!!! app.js REMOVED ACTIVITIES
app.post('/insert-event-database', (req, res) => {
console.log(req.body);

const {
eventnameInput,
startDateEvent,
endDateEvent,
eventScope,
activityname,
activitydate
} = req.body;

// Check if the event with the provided name already exists in the event table
db.query('SELECT event_name FROM event WHERE event_name = ?', [eventnameInput], async (error, results) => {
if (error) {
console.log(error);
return res.status(500).json({ error: 'Error checking existing event' });
}

// Insert the event data into the event table if it doesn't already exist
if (results.length === 0) {
db.query('INSERT INTO event SET ?', {
event_name: eventnameInput,
event_date_start: startDateEvent,
event_date_end: endDateEvent,
event_scope: eventScope
}, (error, eventResults) => {
if (error) {
console.log(error);
return res.status(500).json({ error: 'Error inserting event data' });
}

const eventId = eventResults.insertId;

// Insert data into activities table
if (Array.isArray(activityname) && Array.isArray(activitydate)) {
for (let i = 0; i < activityname.length; i++) { db.query('INSERT INTO activities SET ?', { activity_name:
    activityname[i], activity_date: activitydate[i], event_id: eventId, }, (error, activityResults)=> {
    if (error) {
    console.log(error);
    return res.status(500).json({ error: 'Error inserting activity data' });
    }
    console.log(activityResults);
    });
    }
    }

    return res.status(200).json({
    message: `Event ${eventnameInput} and activities successfully created`
    });
    });
    } else {
    return res.status(400).json({ error: 'There is already an existing event', event_name: eventnameInput });
    }

    // Store user-related data in the session
    req.session.eventDate = {
    event_name: eventnameInput,
    event_date_start: startDateEvent,
    event_date_end: endDateEvent,
    event_scope: eventScope,
    // activity_name: activityname,
    // activity_date: activitydate
    };
    });
    });


    !!! navbarUniversityEdit REMOVED ACTIVITIES
    <form action="/insert-event-database" method="POST" id="addForm">
        <div id="myPopupEvent" class="popup myPopupEvent">
            <div class="flex-container popup-content">
                <span id="closeButton" class="close-button closePopup" data-popup-id="myPopupEvent">&times;</span>
                <h1 class="flex-container">ADD <p id="eventScope" name="eventScope">INSTITUTIONAL</p>
                    EVENT</h1>
                <div class="flex-container add-events-container">
                    <div class="flex-container add-events-holder">
                        <input type="text" id="eventnameInput" name="eventnameInput" class="eventname add-event-inputs"
                            placeholder="Event Name" />
                        <input type="date" id="startDateEvent" name="startDateEvent"
                            class="eventdate add-event-inputs" />
                        <p class="date-dash">-</p>
                        <input type="date" id="endDateEvent" name="endDateEvent" class="eventdate add-event-inputs" />
                    </div>
                    <div class="flex-container add-activities-events-holder">
                        Activities
                        <hr class="popup-hr" />
                        <div class="inputs">
                            <input type="text" id="activityname" name="activityname" placeholder="Activity Name"
                                class="activityname-main add-event-inputs" />
                            <input type="date" id="activitydate" name="activitydate"
                                class="activitydate add-event-inputs" />
                        </div>
                    </div>
                    <div class="flex-container add-events-container-button">
                        <button id="addMore" class="addMore" type="button">Add More
                            Activities</button>
                        <button id="confirmButton" class="confirmButton" data-popup-id="myPopupEvent"
                            type="button">CONFIRM</button>
                    </div>
                </div>
            </div>
        </div>
    </form>


    !!!app.js EVENTS-ACTIVITIES
    const formData = {
    eventnameInput: document.getElementById('eventnameInput').value,
    startDateEvent: document.getElementById('startDateEvent').value,
    endDateEvent: document.getElementById('endDateEvent').value,
    eventScope: document.getElementById('eventScope').textContent,
    activityname: document.getElementById('activityname').value,
    activitydate: document.getElementById('activitydate').value,
    };
    fetch('/insert-event-database', {
    method: 'POST',
    headers: {
    'Content-Type': 'application/json',
    },
    body: JSON.stringify(formData),
    })
    .then((response) => {
    // Handle the response
    })
    .catch((error) => {
    console.error('Error:', error);
    });
   
    app.post('/insert-event-database', (req, res) => {
        console.log(req.body);
    
        const {
            eventnameInput,
            startDateEvent,
            endDateEvent,
            eventScope,
            activityname,
            activitydate
        } = req.body;
    
        // Check if the event with the provided name already exists in the event table
        db.query('SELECT event_name FROM event WHERE event_name = ?', [eventnameInput], async (error, results) => {
            if (error) {
                console.log(error);
                return res.status(500).json({ error: 'Error checking existing event' });
            }
    
            // Insert the event data into the event table if it doesn't already exist
            if (results.length === 0) {
                db.query('INSERT INTO event SET ?', {
                    event_name: eventnameInput,
                    event_date_start: startDateEvent,
                    event_date_end: endDateEvent,
                    event_scope: eventScope
                }, (error, eventResults) => {
                    if (error) {
                        console.log(error);
                        return res.status(500).json({ error: 'Error inserting event data' });
                    }
    
                    const eventId = eventResults.insertId;
    
                    // Insert data into activities table
                    db.query('INSERT INTO activities SET ?', {
                        activity_name: activityname,
                        activity_date: activitydate,
                        event_id: eventId,
                    }, (error, activityResults) => {
                        if (error) {
                            console.log(error);
                            return res.status(500).json({ error: 'Error inserting activity data' });
                        }
    
                        console.log(activityResults);
                        return res.status(200).json({
                            message: `Event ${eventnameInput} and activity ${activityname} successfully created`
                        });
                    });
                });
            } else {
                return res.status(400).json({ error: 'There is already an existing event', event_name: eventnameInput });
            }
    
            // Store user-related data in the session
            req.session.eventDate = {
                event_name: eventnameInput,
                event_date_start: startDateEvent,
                event_date_end: endDateEvent,
                event_scope: eventScope,
                // activity_name: activityname,
                // activity_date: activitydate
            };
        });
    });
    

    <tr>
        <td>
          <div class="flex-container">
            <div class="flex-container edit-activity-images">
              <button type="button" id="myButtonActivityEdit2" class="myButtonActivityEdit modify-button"
                data-popup-id="myPopupActivityEdit2">
                <img src="../img/Edit (1).png" alt="Edit Activity" class="img-edit-activity-details">
              </button>

              <div id="myPopupActivityEdit2" class="popup">
                <div class="flex-container popup-content">
                  <span id="closeButton" class="close-button closePopup"
                    data-popup-id="myPopupActivityEdit1">&times;</span>
                  <h1>EDIT ACTIVITY</h1>
                  <div class="flex-container add-activities-holder">
                    <div>
                      <input type="text" name="activityname" placeholder="Activity Name"
                        class="activityname-main add-activity-inputs" />
                      <input type="date" name="activitydate" class="activitydate add-activity-inputs" />
                    </div>
                  </div>

                  <div class="flex-container add-activities-container-button">
                    <button id="closePopup" class="closePopup" type="button"
                      data-popup-id="myPopupActivityEdit2">SAVE</button>
                  </div>
                </div>
              </div>

              <button type="button" id="myButtonActivityDelete2" class="myButtonActivityDelete modify-button"
                data-popup-id="myPopupActivityDelete2">
                <img src="../img/Cancel.png" alt="Delete Activity" class="img-delete-activity">
              </button>
            </div>
            <p id="recordActivityName" class="activityNameSpecific activityNameSpecificEdit"></p>
          </div>
        </td>
        <div id="myPopupActivityDelete2" class="popup">
          <div class="flex-container popup-content">
            <span id="closeButton" class="close-button closePopup"
              data-popup-id="myPopupActivityDelete2">&times;</span>
            <h1>DELETE ACTIVITY?</h1>
            <h3>WARNING</h3>
            <p class="delete-warning">This will remove all existing records stored within the
              activity page. Are you sure you wish to proceed?
            </p>

            <div class="flex-container add-activities-container-button">
              <button id="closeDeletePopup" class="closePopup" type="button"
                data-popup-id="myPopupActivityDelete2">DELETE</button>
            </div>
          </div>
        </div>

        <td id="recordActivityDate"></td>
        <td>
          <select name="student role dropdown" class="student-role-dropdown" disabled>
            <option disabled="disabled" selected="selected">Select Student Role</option>
            <option value="INDIV Participant">INDIV Participant</option>
            <option value="TEAM Participant">TEAM Participant</option>
            <option value="PROG. Spectator">PROG. Spectator</option>
            <option value="OTH. Spectator">OTH. Spectator</option>
          </select>
        </td>
        <td>5</td>
        <td>Ryle Ilisan</td>
      </tr>


      document.addEventListener("DOMContentLoaded", function () {
        const startDateInput = document.getElementById("startDateEvent");
        const endDateInput = document.getElementById("endDateEvent");
    
        startDateInput.addEventListener("change", function () {
            endDateInput.min = startDateInput.value;
        });
    
        // Function to set activity date range based on input fields
        function setActivityDateRangeFromInputs() {
            const startDate = new Date(startDateInput.value);
            const endDate = new Date(endDateInput.value);
            setActivityDateRange(startDate, endDate);
        }
    
        // Function to set activity date range based on session or local storage
        function setActivityDateRangeFromStorage() {
            const startDate = new Date(sessionStorage.getItem("startDateEvent"));
            const endDate = new Date(sessionStorage.getItem("endDateEvent"));
            setActivityDateRange(startDate, endDate);
        }
    
        // Function to set activity date range
        function setActivityDateRange(startDate, endDate) {
            // Adjust for time zone offset
            const timezoneOffset = startDate.getTimezoneOffset();
            startDate.setMinutes(startDate.getMinutes() - timezoneOffset);
            endDate.setMinutes(endDate.getMinutes() - timezoneOffset);
    
            // Select all activitydate inputs dynamically
            const activityDateInputs = document.querySelectorAll("input[name='activitydate[]']");
            const activityDateInputsRecord = document.querySelectorAll("input[name='activitydateRecord[]']");
    
            activityDateInputs.forEach(function (activityDateInput) {
                activityDateInput.min = startDate.toISOString().split("T")[0];
                activityDateInput.max = endDate.toISOString().split("T")[0];
            });
    
            activityDateInputsRecord.forEach(function (activityDateInputRecord) {
                activityDateInputRecord.min = startDate.toISOString().split("T")[0];
                activityDateInputRecord.max = endDate.toISOString().split("T")[0];
            });
        }
    
        // Add event listeners for date inputs
        startDateInput.addEventListener("change", setActivityDateRangeFromInputs);
        endDateInput.addEventListener("change", setActivityDateRangeFromInputs);
    
    
        const addMoreButtons = document.querySelectorAll(".addMore");
    
        addMoreButtons.forEach(function (addMoreButton) {
            addMoreButton.addEventListener("click", function () {
                // Find the corresponding '.inputs' container for this button
                let inputs = document.querySelector(".inputs");
    
                let newInputName = document.createElement("input");
                newInputName.id = "activityname";
                newInputName.type = "text";
                newInputName.placeholder = "Activity Name";
                newInputName.name = "activityname[]";
                newInputName.classList.add("activityname-main", "add-event-inputs");
    
                let newInputDate = document.createElement("input");
                newInputDate.id = "activitydate";
                newInputDate.type = "date";
                newInputDate.name = "activitydate[]";
                newInputDate.classList.add("activitydate", "add-event-inputs");
    
                inputs.appendChild(newInputName);
                inputs.appendChild(newInputDate);
    
                // Trigger the updateActivityDateRange function for the new date input
                setActivityDateRangeFromInputs();
    
                // Update activity date range when the new date input changes
                newInputDate.addEventListener("change", setActivityDateRangeFromInputs);
            });
        });
    
        const addMoreActivitiesButtons = document.querySelectorAll(".addMoreActivities");
    
        addMoreActivitiesButtons.forEach(function (addMoreActivitiesButton) {
            addMoreActivitiesButton.addEventListener("click", function () {
                // Find the corresponding '.inputs' container for this button
                let inputs = document.querySelector(".inputsActivity");
    
                let newInputName = document.createElement("input");
                newInputName.type = "text";
                newInputName.id = "recordActivityName";
                newInputName.placeholder = "Activity Name";
                newInputName.name = "activitynameRecord[]";
                newInputName.classList.add("activityname-main", "add-activity-inputs");
    
                let newInputDate = document.createElement("input");
                newInputDate.type = "date";
                newInputDate.id = "recordActivityDate";
                newInputDate.name = "activitydateRecord[]";
                newInputDate.classList.add("activitydate", "add-activity-inputs");
    
                inputs.appendChild(newInputName);
                inputs.appendChild(newInputDate);
    
                setActivityDateRangeFromStorage();
    
                // Update activity date range when the new date input changes
                newInputDate.addEventListener("change", setActivityDateRangeFromStorage);
            });
        });
    
        document.body.addEventListener("click", function (event) {
            const clickedElement = event.target;
            const eventNameElement = clickedElement.closest(".nav-link .eventNameSpecific");
    
            if (eventNameElement) {
                event.preventDefault();
    
                const eventName = eventNameElement.textContent.trim();
    
                fetch(`/university-events-admin/eventroute?eventNameSpecific=${eventName}`)
                    .then((response) => response.json())
                    .then((data) => {
                        console.log("Server response:", data);
    
                        sessionStorage.setItem("eventData", JSON.stringify(data));
                        localStorage.setItem("eventData", JSON.stringify(data));
    
                        const eventId = data.eventData.event_id;
                        sessionStorage.setItem("currentEventId", eventId);
    
                        // Extract the start and end dates from the fetched event data
                        const startDate = new Date(data.eventData.event_date_start);
                        const endDate = new Date(data.eventData.event_date_end);
                        const numberOfDays = Math.floor((endDate - startDate) / (24 * 60 * 60 * 1000)) + 1;
    
                        sessionStorage.setItem("startDateEvent", startDate.toISOString());
                        sessionStorage.setItem("endDateEvent", endDate.toISOString());
    
                        localStorage.setItem("startDateEvent", startDate.toISOString());
                        localStorage.setItem("endDateEvent", endDate.toISOString());
    
                        sessionStorage.setItem("numberOfDays", numberOfDays);
                        localStorage.setItem("numberOfDays", numberOfDays);
    
                        // Set the activity date range based on storage
                        setActivityDateRangeFromStorage();
    
                        // Move the code to populate the dropdown inside this block
                        let eventDaysDropdown = document.getElementById("activity-day-dropdown");
                        eventDaysDropdown.innerHTML = "";
    
                        for (let i = 1; i <= numberOfDays; i++) {
                            const option = document.createElement("option");
                            option.value = i;
                            option.text = `Day ${i}`;
                            eventDaysDropdown.appendChild(option);
                        }
    
                        let fetchedEventName = data.eventData.event_name;
    
                        let selectedDay = null; // Reset selected day when fetching new event data
    
                        selectedDay = localStorage.getItem(`${fetchedEventName}_selectedEventDay`);
                        // Retrieve the selected day for this specific event from localStorage
                        // Set the selected value in the dropdown
                        if (selectedDay) {
                            eventDaysDropdown.value = selectedDay;
                            displayEventDetails(data, numberOfDays, selectedDay, fetchedEventName);
                        }
    
                        // Remove the existing event listener before adding a new one
                        eventDaysDropdown.removeEventListener("change", eventHandlerFunction);
    
                        // Add an event listener to the dropdown to store the selected day in localStorage
                        eventDaysDropdown.addEventListener("change", eventHandlerFunction);
    
                        let previousSelectedDay = null; // Variable to track the previously selected day
    
                        // Function to handle the dropdown change event
                        function eventHandlerFunction() {
                            const newSelectedDay = this.value;
    
                            // Check if the selected day is valid for the current event
                            if (newSelectedDay <= numberOfDays) {
                                selectedDay = newSelectedDay;
    
                                // Check if the selected day has changed and it's not null
                                if (selectedDay !== null && selectedDay !== previousSelectedDay) {
                                    localStorage.setItem(`${fetchedEventName}_selectedEventDay`, selectedDay);
                                    console.log(`Selected Day for ${fetchedEventName}: ${selectedDay}`);
                                }
    
                                // Update the previousSelectedDay
                                previousSelectedDay = selectedDay;
    
                                // Update the page with the new selected day
                                displayEventDetails(data, numberOfDays, selectedDay, fetchedEventName);
                            } else {
                                // Clear the selected day from localStorage for this event
                                localStorage.removeItem(`${fetchedEventName}_selectedEventDay`);
                            }
                        }
                    })
                    .catch((error) => {
                        console.error("Error fetching event data:", error);
                    });
            }
        });
    
    
    
    
        function displayEventDetails(eventData, numberOfDays, selectedDay, fetchedEventName) {
            console.log("Display Event Details function called");
    
            console.log("Event Data:", eventData);
    
            const recordEventName = document.getElementById("recordEventName");
            recordEventName.innerHTML = "";
    
            const isAdminURL = document.querySelector('#isAdminURL').value === "true";
    
            if (eventData && eventData.eventFound) {
                console.log("Event found:", eventData.eventData.event_name);
    
                recordEventName.textContent = `${eventData.eventData.event_name}`;
    
                // if (selectedDay !== null) {
                //     console.log(`Selected Day for ${eventName}: ${selectedDay}`);
                // }
    
                // Assuming you have a table body element with the id "eventTableBody"
                const tableBody = document.getElementById("eventTableBody");
    
                // Clear the table body before adding new rows
                tableBody.innerHTML = "";
    
                // Display activities
                if (eventData.eventData.activities && eventData.eventData.activities.length > 0) {
                    console.log("e", eventData.eventData.event_id);
    
                    eventData.eventData.activities.forEach((activity, index) => {
                        const row = document.createElement("tr");
    
                        // Create the container for activity name and img
                        const activityParentContainer = document.createElement("td");
    
                        const activityNameElement = document.createElement("p");
                        activityNameElement.id = `recordActivityName${index}`;
                        activityNameElement.classList.add("activityNameSpecific", "activityNameSpecificEdit");
                        activityNameElement.textContent = activity.activity_name;
    
                        const activityDateElement = document.createElement("td");
                        activityDateElement.id = `recordActivityDate${index}`;
                        // Format the activity date
                        const activityDate = new Date(activity.activity_date);
                        const formattedActivityDate = `${activityDate.getMonth() + 1}/${activityDate.getDate()}/${activityDate.getFullYear()}`;
                        activityDateElement.textContent = formattedActivityDate;
    
                        const roleElement = document.createElement("td");
    
                        // Create the select element
                        const selectElement = document.createElement("select");
                        selectElement.name = "student role dropdown";
                        selectElement.classList.add("student-role-dropdown");
    
                        // Create and append options to the select element
                        const defaultOption = document.createElement("option");
                        defaultOption.selected = true;
                        defaultOption.disabled = true;
                        defaultOption.textContent = "Select Student Role";
                        selectElement.appendChild(defaultOption);
    
                        const roles = ["INDIV Participant", "TEAM Participant", "PROG. Spectator", "OTH. Spectator"];
                        roles.forEach((role) => {
                            const option = document.createElement("option");
                            option.value = role;
                            option.textContent = role;
                            selectElement.appendChild(option);
                        });
    
                        roleElement.appendChild(selectElement);
    
                        const pointsElement = document.createElement("td");
    
                        // Add event listener to the select element
                        selectElement.addEventListener("change", function () {
                            const selectedRole = this.value;
                            let points;
    
                            switch (selectedRole) {
                                case "TEAM Participant":
                                    points = 15;
                                    break;
                                case "INDIV Participant":
                                    points = 10;
                                    break;
                                case "PROG. Spectator":
                                    points = 5;
                                    break;
                                case "OTH. Spectator":
                                    points = 3;
                                    break;
                                default:
                                    points = 0; // You might want to set a default value here
                            }
    
                            pointsElement.textContent = points.toString();
                            localStorage.setItem("selectedRole", selectedRole);
                        });
    
                        const officerElement = document.createElement("td");
                        const adminData = document.getElementById("adminData");
                        let adminDataElement = adminData.textContent;
                        adminDataElement = adminDataElement.split("|").pop().trim(); // Remove string before | and trim any extra spaces
    
                        officerElement.textContent = adminDataElement;
    
                        if (isAdminURL) {
                            activityParentContainer.appendChild(activityNameElement);
    
                            selectElement.addEventListener("change", function () {
                                var selectedOption = selectElement.options[selectElement.selectedIndex];
                                selectElement.style.color = getComputedStyle(selectedOption).color;
                            });
                        } else {
                            const activityContainer = document.createElement("div");
                            activityContainer.classList.add("flex-container");
                            activityParentContainer.appendChild(activityContainer);
    
                            const editActivityImages = document.createElement("div");
                            editActivityImages.classList.add("flex-container", "edit-activity-images");
                            activityContainer.appendChild(editActivityImages);
    
                            const myButtonActivityEdit = document.createElement("button");
                            myButtonActivityEdit.type = "button";
                            myButtonActivityEdit.id = "myButtonActivityEdit1";
                            myButtonActivityEdit.classList.add("myButtonActivityEdit", "modify-button");
                            myButtonActivityEdit.setAttribute("data-popup-id", "myPopupActivityEdit1");
                            editActivityImages.appendChild(myButtonActivityEdit);
    
                            const imgEditActivityDetails = document.createElement("img");
                            imgEditActivityDetails.src = "../img/Edit (1).png";
                            imgEditActivityDetails.alt = "Edit Activity";
                            imgEditActivityDetails.classList.add("img-edit-activity-details");
                            myButtonActivityEdit.appendChild(imgEditActivityDetails);
    
                            const myButtonActivityDelete = document.createElement("button");
                            myButtonActivityDelete.type = "button";
                            myButtonActivityDelete.id = "myButtonActivityDelete";
                            myButtonActivityDelete.classList.add("myButtonActivityDelete", "modify-button");
                            myButtonActivityDelete.setAttribute("data-popup-id", "myButtonActivityDelete");
                            editActivityImages.appendChild(myButtonActivityDelete);
    
                            const imgDeleteActivity = document.createElement("img");
                            imgDeleteActivity.src = "../img/Cancel.png";
                            imgDeleteActivity.alt = "Delete Activity";
                            imgDeleteActivity.classList.add("img-delete-activity");
                            myButtonActivityDelete.appendChild(imgDeleteActivity);
    
                            editActivityImages.appendChild(activityNameElement);
    
                            selectElement.disabled = true;
    
                            defaultOption.disabled = true;
                        }
    
                        row.appendChild(activityParentContainer);
                        row.appendChild(activityDateElement);
                        row.appendChild(roleElement);
                        row.appendChild(pointsElement);
                        row.appendChild(officerElement);
    
                        // Append the row to the table body
                        tableBody.appendChild(row);
                    });
    
                    if (tableBody.rows.length > 5) {
                        for (let i = 5; i < tableBody.rows.length; i++) {
                            const row = tableBody.rows[i];
                            row.classList.add("hidden-row");
                            row.setAttribute("data-visible", "false");
                        }
    
                        const seeMoreRow = document.createElement("tr");
                        seeMoreRow.classList.add("see-more-row");
                        const seeMoreCell = document.createElement("td");
                        seeMoreCell.colSpan = 5;
                        seeMoreCell.classList.add("see-more");
                        seeMoreCell.textContent = "See More";
                        seeMoreRow.appendChild(seeMoreCell);
                        tableBody.appendChild(seeMoreRow);
    
                        const seeMoreButton = document.querySelector(".see-more");
                        const hiddenRows = document.querySelectorAll(".hidden-row");
    
                        seeMoreButton.addEventListener("click", function () {
                            hiddenRows.forEach((row) => {
                                const isVisible = row.getAttribute("data-visible") === "true";
                                row.style.display = isVisible ? "none" : "table-row";
                                row.setAttribute("data-visible", !isVisible);
                            });
    
                            if (seeMoreButton.textContent === "See More") {
                                seeMoreButton.textContent = "See Less";
                            } else {
                                seeMoreButton.textContent = "See More";
                            }
                        });
                    }
    
    
                }
            } else {
                const errorMessageElement = recordEventName;
                errorMessageElement.textContent = "Event not found.";
                recordEventName.appendChild(errorMessageElement);
            }
        }
    
        // const eventDataSession = JSON.parse(sessionStorage.getItem("eventData"));
        // const eventDataLocal = JSON.parse(localStorage.getItem("eventData"));
    
        // const numberOfDaysSession = sessionStorage.getItem("numberOfDays");
        // const numberOfDaysLocal = localStorage.getItem("numberOfDays");
    
        // // Display the event details
        // displayEventDetails(eventDataSession, eventDataLocal, numberOfDaysSession, numberOfDaysLocal);
    });
    
    const myButtonEvent = document.querySelectorAll(".myButtonEvent");
    
    myButtonEvent.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const myButtonEventEdit = document.querySelectorAll(".myButtonEventEdit");
    
    myButtonEventEdit.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const myButtonEventDelete = document.querySelectorAll(".myButtonEventDelete");
    
    myButtonEventDelete.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const myButtonActivityAdd = document.querySelectorAll(".myButtonActivityAdd");
    
    myButtonActivityAdd.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const myButtonActivityEdit = document.querySelectorAll(".myButtonActivityEdit");
    
    myButtonActivityEdit.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const myButtonActivityDelete = document.querySelectorAll(".myButtonActivityDelete");
    
    myButtonActivityDelete.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "block";
            }
        });
    });
    
    const closeButtons = document.querySelectorAll(".closePopup");
    
    closeButtons.forEach((button) => {
        button.addEventListener("click", function () {
            const popupId = this.getAttribute("data-popup-id");
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.style.display = "none";
            }
        });
    });
    
    const confirmButtons = document.querySelectorAll(".confirmButton");
    
    confirmButtons.forEach((button) => {
        button.addEventListener("click", (event) => {
            event.preventDefault();
    
            const eventName = document.getElementById("eventnameInput").value;
            const eventNameUpper = eventName.toUpperCase();
    
            // Collect form data from input fields
            const formData = {
                eventnameInput: eventNameUpper,
                startDateEvent: document.getElementById("startDateEvent").value,
                endDateEvent: document.getElementById("endDateEvent").value,
                eventScope: document.getElementById("eventScope").textContent,
                eventDays: calculateEventDays(
                    document.getElementById("startDateEvent").value,
                    document.getElementById("endDateEvent").value
                ),
                activities: collectActivitiesData(),
            };
    
            // Send the data to the server using the Fetch API
            fetch("/insert-event-database", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(formData),
            })
                .then((response) => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        const popupId = button.getAttribute("data-popup-id");
                        const popup = document.getElementById(popupId);
                        if (popup) {
                            popup.style.display = "none";
                        }
    
                        console.error("Error sending data to the server");
    
                        const errorResponse = document.getElementById("errorResponse");
                        errorResponse.textContent = `There is already an existing event`;
                        errorResponse.classList.remove("hidden");
                        errorResponse.classList.add("user-prompt", "slide-in");
                        setTimeout(function () {
                            errorResponse.classList.add("hidden");
                        }, 4000);
    
                        throw new Error("Server error");
                    }
                })
                .then((data) => {
                    const startDate = new Date(formData.startDateEvent);
                    const endDate = new Date(formData.endDateEvent);
                    const numberOfDays = Math.floor((endDate - startDate) / (24 * 60 * 60 * 1000)) + 1;
    
                    document.getElementById("eventDays").value = numberOfDays;
    
                    const popupId = button.getAttribute("data-popup-id");
                    const popup = document.getElementById(popupId);
                    if (popup) {
                        popup.style.display = "none";
                    }
    
                    const successResponse = document.getElementById("successResponse");
                    successResponse.textContent = data.message;
    
                    successResponse.classList.remove("hidden");
                    successResponse.classList.add("user-prompt", "slide-in");
                    setTimeout(function () {
                        successResponse.classList.add("hidden");
                        location.reload();
                    }, 2300);
                })
                .catch((error) => {
                    console.error("Error:", error);
                });
        });
    });
    
    
    function collectActivitiesData(eventId) {
        const activityInputs = document.querySelectorAll("input[name='activityname[]']");
        const dateInputs = document.querySelectorAll("input[name='activitydate[]']");
    
        const activitiesData = [];
    
        activityInputs.forEach((activityInput, index) => {
            const activityName = activityInput.value;
            const activityDate = dateInputs[index].value;
    
            if (!activityName || !activityDate) {
                console.log("Skipping activity with undefined name, date, or eventId:", {
                    activityName,
                    activityDate,
                    eventId,
                    index,
                    activityInput,
                    dateInput: dateInputs[index],
                });
                return; // Skip this iteration if data is undefined
            }
    
            activitiesData.push({
                activityName,
                activityDate,
                eventId,
            });
        });
    
        return activitiesData;
    }
    
    
    const confirmActivityButton = document.querySelectorAll(".confirmActivityButton");
    
    confirmActivityButton.forEach((button) => {
        button.addEventListener("click", (event) => {
            event.preventDefault();
    
            const eventId = sessionStorage.getItem("currentEventId"); // Retrieve the event ID
            console.log("session curent", eventId);
    
            const activitiesData = insertActivitiesData(eventId);
    
            if (activitiesData.length === 0) {
                console.log("No activity data to insert.");
                return;
            }
    
            const formData = {
                eventId,
                activities: activitiesData,
                // ... other activity-related data
            };
    
            // Send the data to the server using the Fetch API
            fetch("/insert-activity-database", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(formData),
            })
                .then((response) => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        const popupId = button.getAttribute("data-popup-id");
                        const popup = document.getElementById(popupId);
                        if (popup) {
                            popup.style.display = "none";
                        }
    
                        console.error("Error sending data to the server");
    
                        // const errorResponse = document.getElementById("errorResponse");
                        // errorResponse.textContent = `There is already an existing event`;
                        // errorResponse.classList.remove("hidden");
                        // errorResponse.classList.add("user-prompt", "slide-in");
                        // setTimeout(function () {
                        //     errorResponse.classList.add("hidden");
                        // }, 4000);
    
                        throw new Error("Server error");
                    }
                })
                .then((data) => {
                    const popupId = button.getAttribute("data-popup-id");
                    const popup = document.getElementById(popupId);
                    if (popup) {
                        popup.style.display = "none";
                    }
    
                    const successResponse = document.getElementById("successResponse");
                    successResponse.textContent = data.message;
    
                    successResponse.classList.remove("hidden");
                    successResponse.classList.add("user-prompt", "slide-in");
                    setTimeout(function () {
                        successResponse.classList.add("hidden");
                        location.reload();
                    }, 2300);
                })
                .catch((error) => {
                    console.error("Error:", error);
                });
        });
    });
    
    function insertActivitiesData(eventId) {
        const activityInputs = document.querySelectorAll("input[name='activitynameRecord[]']");
        const dateInputs = document.querySelectorAll("input[name='activitydateRecord[]']");
    
        const activitiesData = [];
    
        activityInputs.forEach((activityInput, index) => {
            const activityName = activityInput.value;
            const activityDate = dateInputs[index].value;
    
            if (!activityName || !activityDate) {
                console.log("Skipping activity with undefined name, date, or eventId:", {
                    activityName,
                    activityDate,
                    eventId,
                    index,
                    activityInput,
                    dateInput: dateInputs[index],
                });
                return; // Skip this iteration if data is undefined
            }
    
            activitiesData.push({
                activityName,
                activityDate,
                eventId,
            });
        });
    
        return activitiesData;
    }
    
    function calculateEventDays(startDate, endDate) {
        const start = new Date(startDate);
        const end = new Date(endDate);
        return Math.floor((end - start) / (24 * 60 * 60 * 1000)) + 1;
    }
    
    const today = new Date().toISOString().split("T")[0];
    
    document.getElementById("startDateEvent").min = today;
    document.getElementById("endDateEvent").min = today;
    
    // When the window loads, check for previously saved selectedRole in localStorage and set the dropdown value
    // window.addEventListener("load", function () {
    //     // const eventDataSession = JSON.parse(sessionStorage.getItem("eventData"));
    //     // const eventDataLocal = JSON.parse(localStorage.getItem("eventData"));
    
    //     // const numberOfDaysSession = sessionStorage.getItem("numberOfDays");
    //     // const numberOfDaysLocal = localStorage.getItem("numberOfDays");
    
    //     // // Display the event details
    //     // displayEventDetails(eventDataSession, eventDataLocal, numberOfDaysSession, numberOfDaysLocal);
    
    //     const selectedRole = localStorage.getItem("selectedRole");
    //     if (selectedRole) {
    //         // Find the select element
    //         const selectElement = document.querySelector(".student-role-dropdown");
    
    //         // Set the value to the previously selected role
    //         selectElement.value = selectedRole;
    
    //         // Manually trigger the change event to update pointsElement based on the selected role
    //         const changeEvent = new Event("change");
    //         selectElement.dispatchEvent(changeEvent);
    //     }
    // });